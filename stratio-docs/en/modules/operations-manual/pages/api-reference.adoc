= API reference

== _ClusterConfig_

This Kubernetes resource allows you to define the various configurations for the _keoscluster_ resource alongside which it is created.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parameter | Description | Default value | Validation

| *`metadata`* https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#objectmeta-v1-meta[ObjectMeta]
| See the Kubernetes API documentation for _metadata_ fields.
| -
| -

| *`spec`* _ClusterConfigSpec_
| -
| -
| -

| *`status`* _ClusterConfigStatus_
| -
| -
| -
|===

=== _ClusterConfigSpec_

This resource defines the desired state of the _ClusterConfig_ resource.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parameter | Description | Default value | Validation

| *`eks_lb_controller`* _boolean_
| Enables the `aws-load-balancer-controller` operator to be installed.
| false
| -

| *`private_registry`* _boolean_
| Specifies the type of installation. If this field is enabled, images to be downloaded during the cluster installation process will be retrieved from the registry specified as _keos++_++registry_.
| true
| -

| *`private_helm_repo`* _boolean_
| Specifies the type of installation. If enabled, the charts required for the cluster installation will be downloaded from the repository specified as _helm++_++repository_.
| true
| -

| *`capx`* _CAPX_
| Allows specifying the versions of Cluster API components (CAPI, CAPA, CAPZ, CAPG) and their associated images to deploy the cluster. Useful for customizing infrastructure controller versions.
| -
| -

| *`charts`* _array[Chart]_
| Allows specifying a list of charts to be installed in the cluster, including the name and version of each.
| -
| -

| *`cluster_operator_image_version`* _string_
| Overrides the image version to be deployed with the chart. By default, the version defined in the chart's _values.yaml_ file is used, but this field allows setting a specific version instead.
| -
| -

| *`cluster_operator_version`* _string_
| Version of the _cluster operator_ chart to be downloaded from the Helm repository configured in the _keoscluster_ resource. If not specified, the latest available version will be used.
| -
| -

| *`controlplane_config`* _ControlplaneConfig_
| Allows specifying configurations for the _control-plane_.
| -
| -

| * `eks_lb_controller`* _boolean_
| Enables the installation of the `aws-load-balancer-controller` operator.
| false
| -

| * `private_helm_repo`* _boolean_
| Specifies whether to use a private Helm repository during installation. If enabled, charts will be downloaded from the repository defined as _helm++_++repository_.
| false
| -

| * `private_registry`* _boolean_
| Specifies whether a private container registry will be used during installation. If enabled, images will be pulled from the registry defined as _keos++_++registry_.
| false
| -
| -

| *`workers_config`* _WorkersConfig_
| Allows specifying configurations for the _worker_ nodes.
| -
| -
|===

=== _ClusterConfigStatus_

Defines the observed status of the _ClusterConfig_ resource.

== _ControlplaneConfig_

Defines the configurations for the _control-plane_.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parameter | Description | Default value | Validation

| *`max_unhealthy`* _integer_
| Specifies the maximum percentage of machines in the _control-plane_ that can be in an _unhealthy_ state before starting the repair.
| 34
| Maximum: 100. Minimum: 0.
|===

== _WorkersConfig_

Defines the configurations for the _workers_ nodes.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parameter | Description | Default value | Validation

| *`max_unhealthy`* _integer_
| Specifies the maximum percentage of machines in a group of _workers_ nodes that can be in an _unhealthy_ state before starting the repair.
| 34
| Maximum: 100. Minimum: 0.
|===
