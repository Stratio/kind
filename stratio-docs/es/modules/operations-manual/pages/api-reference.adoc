= Referencia API

== _ClusterConfig_

Este recurso de Kubernetes permite definir las distintas configuraciones para el recurso _KeosCluster_ junto al que se crea.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parámetro | Descripción | Valor por defecto | Validación

| *`metadata`* https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#objectmeta-v1-meta[ObjectMeta]
| Consulta la documentación de la API de Kubernetes para conocer los campos de _metadata_.
| -
| -

| *`spec`* _ClusterConfigSpec_
| -
| -
| -

| *`status`* _ClusterConfigStatus_
| -
| -
| -
|===

=== _ClusterConfigSpec_

Este recurso define el estado deseado del recurso _ClusterConfig_.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parámetro | Descripción | Valor por defecto | Validación

| *`capx`* _CAPX_
| Permite definir las versiones de los componentes de Cluster API (CAPI, CAPA, CAPZ, CAPG) y sus imágenes asociadas para desplegar el _cluster_. Es útil para personalizar las versiones de los controladores de infraestructura.
| -
| -

| *`cluster_operator_image_version`* _string_
| Permite sobrescribir la versión de la imagen que se desplegará con el _chart_. Por defecto, se usa la versión definida en el archivo _values.yaml_ del _chart_, pero este campo permite sustituirla por una concreta.
| -
| -

| *`cluster_operator_version`* _string_
| Versión del _chart_ del _cluster operator_ que se descargará desde el repositorio Helm configurado en el recurso _KeosCluster_. Si no se indica, se utilizará la última versión disponible.
| -
| -

| *`eks_lb_controller`* _boolean_
| Permite instalar el operador `aws-load-balancer-controller`.
| _false_
| -

| *`private_helm_repo`* _boolean_
| Define si la instalación usará un repositorio Helm privado. Si se activa, los _charts_ se descargarán del repositorio definido como _helm++_++repository_.
| _false_
| -

| *`private_registry`* _boolean_
| Define si la instalación utilizará un _registry_ privado. Si se activa, las imágenes necesarias se obtendrán del _registry_ definido como _keos++_++registry_.
| _false_
| -
|===

=== _ClusterConfigStatus_

Define el estado observado del recurso _ClusterConfig_.

== _ControlplaneConfig_

Define las configuraciones para el _control-plane_.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parámetro | Descripción | Valor por defecto | Validación

| *`max_unhealthy`* _integer_
| Permite especificar el porcentaje máximo de máquinas del _control-plane_ que pueden encontrarse en estado _unhealthy_ antes de comenzar la reparación.
| 34
| Máximo: 100. Mínimo: 0.
|===

== _WorkersConfig_

Define las configuraciones para los nodos _workers_.

[cols="20a,50a,15a,15a", options="header"]
|===
| Parámetro | Descripción | Valor por defecto | Validación

| *`max_unhealthy`* _integer_
| Permite especificar el porcentaje máximo de máquinas de un grupo de nodos _workers_ que pueden encontrarse en estado _unhealthy_ antes de comenzar la reparación.
| 34
| Máximo: 100. Mínimo: 0.
|===
